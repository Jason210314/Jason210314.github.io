<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CS:APP Bomb_lab | OneStep</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="alternate" type="application/rss+xml" href="https://wmc1999.top/rss.xml" title="OneStep RSS Feed">
    <meta name="description" content="CS:APP炸弹实验室通关过程">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/assets/css/0.styles.e4481a5a.css" as="style"><link rel="preload" href="/assets/js/app.acf8092b.js" as="script"><link rel="preload" href="/assets/js/6.036fc43e.js" as="script"><link rel="preload" href="/assets/js/3.e3d55509.js" as="script"><link rel="preload" href="/assets/js/16.e7b2390a.js" as="script"><link rel="preload" href="/assets/js/9.151ac344.js" as="script"><link rel="prefetch" href="/assets/js/10.e077d793.js"><link rel="prefetch" href="/assets/js/11.93b1eff1.js"><link rel="prefetch" href="/assets/js/12.165a8f38.js"><link rel="prefetch" href="/assets/js/13.86b71190.js"><link rel="prefetch" href="/assets/js/14.f7c31146.js"><link rel="prefetch" href="/assets/js/15.b61267d7.js"><link rel="prefetch" href="/assets/js/17.c6ea5fff.js"><link rel="prefetch" href="/assets/js/18.678082c9.js"><link rel="prefetch" href="/assets/js/19.21a8a34e.js"><link rel="prefetch" href="/assets/js/20.9edcae00.js"><link rel="prefetch" href="/assets/js/21.f0f9d500.js"><link rel="prefetch" href="/assets/js/22.b54c9990.js"><link rel="prefetch" href="/assets/js/23.53b24cbf.js"><link rel="prefetch" href="/assets/js/24.659f2811.js"><link rel="prefetch" href="/assets/js/25.d1cafbf8.js"><link rel="prefetch" href="/assets/js/26.b17873ae.js"><link rel="prefetch" href="/assets/js/27.2aa200a3.js"><link rel="prefetch" href="/assets/js/28.15123e9b.js"><link rel="prefetch" href="/assets/js/29.f9430524.js"><link rel="prefetch" href="/assets/js/30.ea435c6a.js"><link rel="prefetch" href="/assets/js/31.cefe08f6.js"><link rel="prefetch" href="/assets/js/32.df4e8226.js"><link rel="prefetch" href="/assets/js/33.ba689688.js"><link rel="prefetch" href="/assets/js/34.55f32c39.js"><link rel="prefetch" href="/assets/js/35.5b664f83.js"><link rel="prefetch" href="/assets/js/36.f179d54b.js"><link rel="prefetch" href="/assets/js/37.11846bd5.js"><link rel="prefetch" href="/assets/js/4.d1c52263.js"><link rel="prefetch" href="/assets/js/5.ed205acd.js"><link rel="prefetch" href="/assets/js/7.43914937.js"><link rel="prefetch" href="/assets/js/8.21172198.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.dfe54976.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4481a5a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">OneStep </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Home</a></li><li class="nav-item"><a href="/blog/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tag</a></li><li class="nav-item"><a href="/about/" class="nav-link">About </a></li><li class="nav-item"><a href="https://github.com/jason210314/" target="_blank" rel="noopener noreferrer" class="nav-link external">github </a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <a href="/rss.xml" class="feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">OneStep </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Home</a></li><li class="mobile-nav-item"><a href="/blog/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tag</a></li><li class="mobile-nav-item"><a href="/about/" class="nav-link">About </a></li><li class="mobile-nav-item"><a href="https://github.com/jason210314/" target="_blank" rel="noopener noreferrer" class="nav-link external">github </a></li> <li class="mobile-nav-item"><a href="/rss.xml" class="feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        CS:APP Bomb_lab
      </h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2018-12-01T17:20:21.000Z">
      2018-12-01
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/CS:APP" data-v-42ccfcd5><span data-v-42ccfcd5>CS:APP</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/汇编" data-v-42ccfcd5><span data-v-42ccfcd5>汇编</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/二进制炸弹" data-v-42ccfcd5><span data-v-42ccfcd5>二进制炸弹</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h1 id="实验步骤"><a href="#实验步骤" class="header-anchor">#</a> 实验步骤</h1> <h2 id="准备工作"><a href="#准备工作" class="header-anchor">#</a> 准备工作</h2> <p>使用<code>tar -vxf</code>将炸弹压缩包解压,cd 进入,可以从 bomb.c 中看出实验的用意以及程序的大致
逻辑,bomb 为可执行程序,使用 gdb 调试该程序.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b read_line
Breakpoint <span class="token number">1</span> at 0x40155c
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b explode_bomb
Breakpoint <span class="token number">2</span> at 0x4014e4
</code></pre></div><p>给 read_line 函数打上断点,以便每次输入运行一关.给 explode_bomb 打上断点,以便在炸弹爆炸
前可以处理.</p> <h2 id="phase-1"><a href="#phase-1" class="header-anchor">#</a> phase_1</h2> <p>获得 phase_1 汇编代码</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disas phase_1
Dump of assembler code <span class="token keyword">for</span> <span class="token keyword">function</span> phase_1:
   0x0000000000400e80 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	sub    <span class="token variable">$0x8</span>,%rsp
   0x0000000000400e84 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    <span class="token variable">$0x4024a0</span>,%esi
   0x0000000000400e89 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	callq  0x40127e <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">&gt;</span>
   0x0000000000400e8e <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	<span class="token builtin class-name">test</span>   %eax,%eax
   0x0000000000400e90 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	je     0x400e97 <span class="token operator">&lt;</span>phase_1+2<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>
   0x0000000000400e92 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x0000000000400e97 <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x8</span>,%rsp
   0x0000000000400e9b <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	retq
End of assembler dump.
</code></pre></div><p>可见,此题是将我们输入的字符串与地址 0x4024a0 处字符串比较,不等则爆炸.查看该字符串.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> x/s 0x4024a0
0x4024a0 <span class="token operator">&lt;</span>__dso_handle+34<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	 <span class="token string">&quot;We have to stand with our North Korean allies.&quot;</span>
</code></pre></div><p>那么答案是 We have to stand with our North Korean allies.</p> <h2 id="phase-2"><a href="#phase-2" class="header-anchor">#</a> phase_2</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disas phase_2
Dump of assembler code <span class="token keyword">for</span> <span class="token keyword">function</span> phase_2:
   0x0000000000400e9c <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	push   %rbp
   0x0000000000400e9d <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	push   %rbx
   0x0000000000400e9e <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	sub    <span class="token variable">$0x28</span>,%rsp
   0x0000000000400ea2 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	mov    %rsp,%rsi
   0x0000000000400ea5 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	callq  0x40151a <span class="token operator">&lt;</span>read_six_numbers<span class="token operator">&gt;</span>
   0x0000000000400eaa <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	cmpl   <span class="token variable">$0x1</span>,<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>
   0x0000000000400eae <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	je     0x400ed0 <span class="token operator">&lt;</span>phase_2+5<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>
   0x0000000000400eb0 <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x0000000000400eb5 <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	jmp    0x400ed0 <span class="token operator">&lt;</span>phase_2+5<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>
   0x0000000000400eb7 <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	mov    -0x4<span class="token punctuation">(</span>%rbx<span class="token punctuation">)</span>,%eax
   0x0000000000400eba <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	<span class="token function">add</span>    %eax,%eax
   0x0000000000400ebc <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	<span class="token function">cmp</span>    %eax,<span class="token punctuation">(</span>%rbx<span class="token punctuation">)</span>
   0x0000000000400ebe <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	je     0x400ec5 <span class="token operator">&lt;</span>phase_2+4<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x0000000000400ec0 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x0000000000400ec5 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x4</span>,%rbx
   0x0000000000400ec9 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	<span class="token function">cmp</span>    %rbp,%rbx
   0x0000000000400ecc <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	jne    0x400eb7 <span class="token operator">&lt;</span>phase_2+2<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>
   0x0000000000400ece <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	jmp    0x400edc <span class="token operator">&lt;</span>phase_2+6<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>
   0x0000000000400ed0 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	lea    0x4<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%rbx
   0x0000000000400ed5 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	lea    0x18<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%rbp
   0x0000000000400eda <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	jmp    0x400eb7 <span class="token operator">&lt;</span>phase_2+2<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>
   0x0000000000400edc <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x28</span>,%rsp
---Type <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to continue, or q <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to quit---
   0x0000000000400ee0 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	pop    %rbx
   0x0000000000400ee1 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	pop    %rbp
   0x0000000000400ee2 <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	retq
End of assembler dump.
</code></pre></div><p>+3 处发现在栈中开辟了 0x28 的内存区域.然后将%rsp 的值传给%rsi 作为
参数传给函数 read_six_numbers,可以看出应该使用开辟的空闲内存做
数组,记数组为 r,读取六个数字.将(%rsp)和 0x1 比较,如果不等,就会爆
炸,(％rsp)为数组首元,故 r[0]＝１;跳转到+52,将 r[1]地址赋给%rbx,
将 r<a href="%E5%AE%9E%E9%99%85%E4%B8%8D%E5%AD%98%E5%9C%A8">6</a>地址赋给%rbp,跳到+27,将%eax 设为%rbx 指向的前一个
数,此时为 r[0],比较 r[1]和 2*r[0]是否相等,不等则爆炸.跳转到+41,％
rbx+4,比较%rbx 和%rbp,不等跳转到+27,重复,等则跳转到+64 结束,成功
.可以看出，这是一个循环比较.等价于下面的 c 语 a 言</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>b <span class="token operator">=</span> <span class="token operator">&amp;</span>r<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> b <span class="token operator">!=</span> <span class="token operator">&amp;</span>r<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> b<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>b <span class="token operator">!=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>b <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        call explode_bomb<span class="token punctuation">;</span>
</code></pre></div><p>故答案应该为 1 2 4 8 16 32.</p> <h2 id="phase-3"><a href="#phase-3" class="header-anchor">#</a> phase_3</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>   0x0000000000400ef1 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    <span class="token variable">$0x4027cd</span>,%esi
   0x0000000000400ef6 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000400efb <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	callq  0x400ba0 <span class="token operator">&lt;</span>__isoc99_sscanf@plt<span class="token operator">&gt;</span>
   0x0000000000400f00 <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x1</span>,%eax
</code></pre></div><p>查看 0x4027cd,</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> x/s 0x4027cd
0x4027cd:	 <span class="token string">&quot;%d %d&quot;</span>
</code></pre></div><p>可知,应该是读入了两个整数.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>   0x0000000000400f15 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	jmpq   *0x402500<span class="token punctuation">(</span>,%rax,8<span class="token punctuation">)</span>
   0x0000000000400f1c <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000400f21 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	jmp    0x400f28 <span class="token operator">&lt;</span>phase_3+6<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
   0x0000000000400f23 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    <span class="token variable">$0x19c</span>,%eax
   0x0000000000400f28 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	sub    <span class="token variable">$0xcd</span>,%eax
   0x0000000000400f2d <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	jmp    0x400f34 <span class="token operator">&lt;</span>phase_3+8<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x0000000000400f2f <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000400f34 <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x29b</span>,%eax
   0x0000000000400f39 <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	jmp    0x400f40 <span class="token operator">&lt;</span>phase_3+9<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>
   0x0000000000400f3b <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
---Type <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to continue, or q <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to quit---
   0x0000000000400f40 <span class="token operator">&lt;</span>+9<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	sub    <span class="token variable">$0x36f</span>,%eax
   0x0000000000400f45 <span class="token operator">&lt;</span>+9<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	jmp    0x400f4c <span class="token operator">&lt;</span>phase_3+10<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>
   0x0000000000400f47 <span class="token operator">&lt;</span>+10<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000400f4c <span class="token operator">&lt;</span>+10<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x36f</span>,%eax
   0x0000000000400f51 <span class="token operator">&lt;</span>+11<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	jmp    0x400f58 <span class="token operator">&lt;</span>phase_3+11<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>
   0x0000000000400f53 <span class="token operator">&lt;</span>+11<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000400f58 <span class="token operator">&lt;</span>+11<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	sub    <span class="token variable">$0x36f</span>,%eax
   0x0000000000400f5d <span class="token operator">&lt;</span>+12<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	jmp    0x400f64 <span class="token operator">&lt;</span>phase_3+12<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
   0x0000000000400f5f <span class="token operator">&lt;</span>+12<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000400f64 <span class="token operator">&lt;</span>+12<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x36f</span>,%eax
   0x0000000000400f69 <span class="token operator">&lt;</span>+13<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	jmp    0x400f70 <span class="token operator">&lt;</span>phase_3+14<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x0000000000400f6b <span class="token operator">&lt;</span>+13<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000400f70 <span class="token operator">&lt;</span>+14<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	sub    <span class="token variable">$0x36f</span>,%eax
   0x0000000000400f75 <span class="token operator">&lt;</span>+14<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	jmp    0x400f81 <span class="token operator">&lt;</span>phase_3+15<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
   0x0000000000400f77 <span class="token operator">&lt;</span>+14<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x0000000000400f7c <span class="token operator">&lt;</span>+15<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000400f81 <span class="token operator">&lt;</span>+15<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	cmpl   <span class="token variable">$0x5</span>,0xc<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>
   0x0000000000400f86 <span class="token operator">&lt;</span>+16<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	jg     0x400f8e <span class="token operator">&lt;</span>phase_3+17<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x0000000000400f88 <span class="token operator">&lt;</span>+16<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	<span class="token function">cmp</span>    0x8<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%eax
   0x0000000000400f8c <span class="token operator">&lt;</span>+16<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	je     0x400f93 <span class="token operator">&lt;</span>phase_3+17<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>
   0x0000000000400f8e <span class="token operator">&lt;</span>+17<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
</code></pre></div><p>由这段汇编代码可知,这是一段 switch 语句,使用输入的第一个值作为 key,
经过对应跳转位置的操作后应与第二个数相等.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *（0x402500 + <span class="token number">32</span>）
<span class="token variable">$1</span> <span class="token operator">=</span> 0x400f47
</code></pre></div><p>那么第一个数为 0 时,跳转到 0x400f23 处,那么第二个数应该为此处的 0x0,
故一组答案为 4 0;</p> <h2 id="phase-4"><a href="#phase-4" class="header-anchor">#</a> phase_4</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disas phase_4
Dump of assembler code <span class="token keyword">for</span> <span class="token keyword">function</span> phase_4:
   0x0000000000400fd0 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	sub    <span class="token variable">$0x18</span>,%rsp
   0x0000000000400fd4 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	lea    0xc<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%rcx
   0x0000000000400fd9 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	lea    0x8<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%rdx
   0x0000000000400fde <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    <span class="token variable">$0x4027cd</span>,%esi
   0x0000000000400fe3 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000400fe8 <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	callq  0x400ba0 <span class="token operator">&lt;</span>__isoc99_sscanf@plt<span class="token operator">&gt;</span>
   0x0000000000400fed <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x2</span>,%eax
   0x0000000000400ff0 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	jne    0x400ffe <span class="token operator">&lt;</span>phase_4+4<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>
   0x0000000000400ff2 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    0xc<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%eax
   0x0000000000400ff6 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	sub    <span class="token variable">$0x2</span>,%eax
   0x0000000000400ff9 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x2</span>,%eax
   0x0000000000400ffc <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	jbe    0x401003 <span class="token operator">&lt;</span>phase_4+5<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x0000000000400ffe <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x0000000000401003 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	mov    0xc<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%esi
   0x0000000000401007 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	mov    <span class="token variable">$0x9</span>,%edi
   0x000000000040100c <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	callq  0x400f98 <span class="token operator">&lt;</span>func<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>
   0x0000000000401011 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	<span class="token function">cmp</span>    0x8<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%eax
   0x0000000000401015 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	je     0x40101c <span class="token operator">&lt;</span>phase_4+7<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>
   0x0000000000401017 <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x000000000040101c <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x18</span>,%rsp
   0x0000000000401020 <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	retq
End of assembler dump.
</code></pre></div><p>由代码易知,phase_4 读入了两个数,第二个数在 2-4 之间,然后将第二个数作为
func4 的第二个参数,func4 第一个参数为 9,输入的第一个数必须和 func4 返回值相等.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disas func4
Dump of assembler code <span class="token keyword">for</span> <span class="token keyword">function</span> func4:
   0x0000000000400f98 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	push   %r12
   0x0000000000400f9a <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	push   %rbp
   0x0000000000400f9b <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	push   %rbx
   0x0000000000400f9c <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    %edi,%ebx
   0x0000000000400f9e <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	<span class="token builtin class-name">test</span>   %edi,%edi
   0x0000000000400fa0 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	jle    0x400fc6 <span class="token operator">&lt;</span>func4+4<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>
   0x0000000000400fa2 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	mov    %esi,%ebp
   0x0000000000400fa4 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	mov    %esi,%eax
   0x0000000000400fa6 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x1</span>,%edi
   0x0000000000400fa9 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	je     0x400fcb <span class="token operator">&lt;</span>func4+5<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x0000000000400fab <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	lea    -0x1<span class="token punctuation">(</span>%rdi<span class="token punctuation">)</span>,%edi
   0x0000000000400fae <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	callq  0x400f98 <span class="token operator">&lt;</span>func<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>
   0x0000000000400fb3 <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	lea    <span class="token punctuation">(</span>%rax,%rbp,1<span class="token punctuation">)</span>,%r12d
   0x0000000000400fb7 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	lea    -0x2<span class="token punctuation">(</span>%rbx<span class="token punctuation">)</span>,%edi
   0x0000000000400fba <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    %ebp,%esi
   0x0000000000400fbc <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	callq  0x400f98 <span class="token operator">&lt;</span>func<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>
   0x0000000000400fc1 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	<span class="token function">add</span>    %r12d,%eax
   0x0000000000400fc4 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	jmp    0x400fcb <span class="token operator">&lt;</span>func4+5<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x0000000000400fc6 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000400fcb <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	pop    %rbx
   0x0000000000400fcc <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	pop    %rbp
   0x0000000000400fcd <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	pop    %r12
   0x0000000000400fcf <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	retq
End of assembler dump.
</code></pre></div><p>此函数等价于下面的 c 代码</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>
<span class="token keyword">int</span> <span class="token function">func4</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> b<span class="token punctuation">;</span>
    <span class="token keyword">return</span> b <span class="token operator">+</span> <span class="token function">func4</span><span class="token punctuation">(</span>a <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">func4</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>穷举 2-4 的值即可得到答案,取答案为 176 2</p> <h2 id="phase-5"><a href="#phase-5" class="header-anchor">#</a> phase_5</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disas phase_5
Dump of assembler code <span class="token keyword">for</span> <span class="token keyword">function</span> phase_5:
   0x0000000000401021 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	push   %rbx
   0x0000000000401022 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	mov    %rdi,%rbx
   0x0000000000401025 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	callq  0x401261 <span class="token operator">&lt;</span>string_length<span class="token operator">&gt;</span>
   0x000000000040102a <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x6</span>,%eax
   0x000000000040102d <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	je     0x401034 <span class="token operator">&lt;</span>phase_5+1<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
   0x000000000040102f <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x0000000000401034 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000401039 <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%edx
   0x000000000040103e <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	movzbl <span class="token punctuation">(</span>%rbx,%rax,1<span class="token punctuation">)</span>,%ecx
   0x0000000000401042 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	and    <span class="token variable">$0xf</span>,%ecx
   0x0000000000401045 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	<span class="token function">add</span>    0x402540<span class="token punctuation">(</span>,%rcx,4<span class="token punctuation">)</span>,%edx
   0x000000000040104c <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x1</span>,%rax
   0x0000000000401050 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x6</span>,%rax
   0x0000000000401054 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	jne    0x40103e <span class="token operator">&lt;</span>phase_5+2<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
   0x0000000000401056 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x27</span>,%edx
   0x0000000000401059 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	je     0x401060 <span class="token operator">&lt;</span>phase_5+6<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>
   0x000000000040105b <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x0000000000401060 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	pop    %rbx
   0x0000000000401061 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	retq
End of assembler dump.
</code></pre></div><p>由汇编代码可知,需要输入一个长度为 6 的字符串.令该字符串为 input,+36 处出现的
数组为 array,则该汇编等价于下面代码.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    sum <span class="token operator">+=</span> array<span class="token punctuation">[</span> input<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>意为遍历输入字符串,取该字符串低 4 位作为 array 下标,取出 array 值相加.
查看 array 的值</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *0x402540@16
<span class="token variable">$2</span> <span class="token operator">=</span> <span class="token punctuation">{</span>0x2, 0xa, 0x6, 0x1, 0xc, 0x10, 0x9, 0x3, 0x4, 0x7, 0xe, 0x5, 0xb, 0x8,
  0xf, 0xd<span class="token punctuation">}</span>
</code></pre></div><p>题目要求 sum = 0x27,故从 array 中选出 6 个和为 0x27 的数,通过这 6 个数的下标找出对应字符.
答案应为 01347L;</p> <h2 id="phase-6"><a href="#phase-6" class="header-anchor">#</a> phase_6</h2> <p>因为课程未对后续两关作要求,故不做特别详细的解答.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disas phase_6
Dump of assembler code <span class="token keyword">for</span> <span class="token keyword">function</span> phase_6:
   0x0000000000401062 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	push   %r13
   0x0000000000401064 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	push   %r12
   0x0000000000401066 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	push   %rbp
   0x0000000000401067 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	push   %rbx
   0x0000000000401068 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	sub    <span class="token variable">$0x58</span>,%rsp
   0x000000000040106c <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	lea    0x30<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%rsi
   0x0000000000401071 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	callq  0x40151a <span class="token operator">&lt;</span>read_six_numbers<span class="token operator">&gt;</span>
   0x0000000000401076 <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	lea    0x30<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%r13
   0x000000000040107b <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%r12d
   0x0000000000401081 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	mov    %r13,%rbp
   0x0000000000401084 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    0x0<span class="token punctuation">(</span>%r13<span class="token punctuation">)</span>,%eax
   0x0000000000401088 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	sub    <span class="token variable">$0x1</span>,%eax
   0x000000000040108b <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x5</span>,%eax
   0x000000000040108e <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	jbe    0x401095 <span class="token operator">&lt;</span>phase_6+5<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x0000000000401090 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x0000000000401095 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x1</span>,%r12d
   0x0000000000401099 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x6</span>,%r12d
   0x000000000040109d <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	jne    0x4010a6 <span class="token operator">&lt;</span>phase_6+6<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
   0x000000000040109f <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%esi
   0x00000000004010a4 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	jmp    0x4010e8 <span class="token operator">&lt;</span>phase_6+13<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>
   0x00000000004010a6 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	mov    %r12d,%ebx
   0x00000000004010a9 <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	movslq %ebx,%rax
---Type <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to continue, or q <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to quit---
   0x00000000004010ac <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    0x30<span class="token punctuation">(</span>%rsp,%rax,4<span class="token punctuation">)</span>,%eax
   0x00000000004010b0 <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	<span class="token function">cmp</span>    %eax,0x0<span class="token punctuation">(</span>%rbp<span class="token punctuation">)</span>
   0x00000000004010b3 <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	jne    0x4010ba <span class="token operator">&lt;</span>phase_6+8<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
   0x00000000004010b5 <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x00000000004010ba <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x1</span>,%ebx
   0x00000000004010bd <span class="token operator">&lt;</span>+9<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x5</span>,%ebx
   0x00000000004010c0 <span class="token operator">&lt;</span>+9<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	jle    0x4010a9 <span class="token operator">&lt;</span>phase_6+7<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x00000000004010c2 <span class="token operator">&lt;</span>+9<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x4</span>,%r13
   0x00000000004010c6 <span class="token operator">&lt;</span>+10<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	jmp    0x401081 <span class="token operator">&lt;</span>phase_6+3<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x00000000004010c8 <span class="token operator">&lt;</span>+10<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	mov    0x8<span class="token punctuation">(</span>%rdx<span class="token punctuation">)</span>,%rdx
   0x00000000004010cc <span class="token operator">&lt;</span>+10<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x1</span>,%eax
   0x00000000004010cf <span class="token operator">&lt;</span>+10<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	<span class="token function">cmp</span>    %ecx,%eax
   0x00000000004010d1 <span class="token operator">&lt;</span>+11<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	jne    0x4010c8 <span class="token operator">&lt;</span>phase_6+10<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>
   0x00000000004010d3 <span class="token operator">&lt;</span>+11<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	jmp    0x4010da <span class="token operator">&lt;</span>phase_6+12<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
   0x00000000004010d5 <span class="token operator">&lt;</span>+11<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	mov    <span class="token variable">$0x603410</span>,%edx
   0x00000000004010da <span class="token operator">&lt;</span>+12<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	mov    %rdx,<span class="token punctuation">(</span>%rsp,%rsi,2<span class="token punctuation">)</span>
   0x00000000004010de <span class="token operator">&lt;</span>+12<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x4</span>,%rsi
   0x00000000004010e2 <span class="token operator">&lt;</span>+12<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x18</span>,%rsi
   0x00000000004010e6 <span class="token operator">&lt;</span>+13<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	je     0x4010fd <span class="token operator">&lt;</span>phase_6+15<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>
   0x00000000004010e8 <span class="token operator">&lt;</span>+13<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    0x30<span class="token punctuation">(</span>%rsp,%rsi,1<span class="token punctuation">)</span>,%ecx
   0x00000000004010ec <span class="token operator">&lt;</span>+13<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x1</span>,%ecx
   0x00000000004010ef <span class="token operator">&lt;</span>+14<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	jle    0x4010d5 <span class="token operator">&lt;</span>phase_6+11<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>
   0x00000000004010f1 <span class="token operator">&lt;</span>+14<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	mov    <span class="token variable">$0x1</span>,%eax
---Type <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to continue, or q <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to quit---
   0x00000000004010f6 <span class="token operator">&lt;</span>+14<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	mov    <span class="token variable">$0x603410</span>,%edx
   0x00000000004010fb <span class="token operator">&lt;</span>+15<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	jmp    0x4010c8 <span class="token operator">&lt;</span>phase_6+10<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>
   0x00000000004010fd <span class="token operator">&lt;</span>+15<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	mov    <span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%rbx
   0x0000000000401101 <span class="token operator">&lt;</span>+15<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	lea    0x8<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%rax
   0x0000000000401106 <span class="token operator">&lt;</span>+16<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	lea    0x30<span class="token punctuation">(</span>%rsp<span class="token punctuation">)</span>,%rsi
   0x000000000040110b <span class="token operator">&lt;</span>+16<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	mov    %rbx,%rcx
   0x000000000040110e <span class="token operator">&lt;</span>+17<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	mov    <span class="token punctuation">(</span>%rax<span class="token punctuation">)</span>,%rdx
   0x0000000000401111 <span class="token operator">&lt;</span>+17<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	mov    %rdx,0x8<span class="token punctuation">(</span>%rcx<span class="token punctuation">)</span>
   0x0000000000401115 <span class="token operator">&lt;</span>+17<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x8</span>,%rax
   0x0000000000401119 <span class="token operator">&lt;</span>+18<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	<span class="token function">cmp</span>    %rsi,%rax
   0x000000000040111c <span class="token operator">&lt;</span>+18<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	je     0x401123 <span class="token operator">&lt;</span>phase_6+19<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>
   0x000000000040111e <span class="token operator">&lt;</span>+18<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	mov    %rdx,%rcx
   0x0000000000401121 <span class="token operator">&lt;</span>+19<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	jmp    0x40110e <span class="token operator">&lt;</span>phase_6+17<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>
   0x0000000000401123 <span class="token operator">&lt;</span>+19<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	movq   <span class="token variable">$0x0</span>,0x8<span class="token punctuation">(</span>%rdx<span class="token punctuation">)</span>
   0x000000000040112b <span class="token operator">&lt;</span>+20<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	mov    <span class="token variable">$0x5</span>,%ebp
   0x0000000000401130 <span class="token operator">&lt;</span>+20<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	mov    0x8<span class="token punctuation">(</span>%rbx<span class="token punctuation">)</span>,%rax
   0x0000000000401134 <span class="token operator">&lt;</span>+21<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	mov    <span class="token punctuation">(</span>%rax<span class="token punctuation">)</span>,%eax
   0x0000000000401136 <span class="token operator">&lt;</span>+21<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	<span class="token function">cmp</span>    %eax,<span class="token punctuation">(</span>%rbx<span class="token punctuation">)</span>
   0x0000000000401138 <span class="token operator">&lt;</span>+21<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	jge    0x40113f <span class="token operator">&lt;</span>phase_6+22<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
   0x000000000040113a <span class="token operator">&lt;</span>+21<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x000000000040113f <span class="token operator">&lt;</span>+22<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	mov    0x8<span class="token punctuation">(</span>%rbx<span class="token punctuation">)</span>,%rbx
   0x0000000000401143 <span class="token operator">&lt;</span>+22<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	sub    <span class="token variable">$0x1</span>,%ebp
   0x0000000000401146 <span class="token operator">&lt;</span>+22<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	jne    0x401130 <span class="token operator">&lt;</span>phase_6+20<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>
---Type <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to continue, or q <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to quit---
   0x0000000000401148 <span class="token operator">&lt;</span>+23<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x58</span>,%rsp
   0x000000000040114c <span class="token operator">&lt;</span>+23<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	pop    %rbx
   0x000000000040114d <span class="token operator">&lt;</span>+23<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	pop    %rbp
   0x000000000040114e <span class="token operator">&lt;</span>+23<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	pop    %r12
   0x0000000000401150 <span class="token operator">&lt;</span>+23<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	pop    %r13
   0x0000000000401152 <span class="token operator">&lt;</span>+24<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	retq
End of assembler dump.
</code></pre></div><p>汇编代码很长.其意为输入 6 个互不相等的数,介于 1-6.按这 6 个数的值从位于地址 0x603410 的链表中选出对应位置的
节点指针,组成一个数组.按选出的顺序将这六个节点组成新的链表,然后检查这个链表是否为降序.
查看链表的值.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603410<span class="token punctuation">)</span>
<span class="token variable">$3</span> <span class="token operator">=</span> 0x1cf
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603410 + <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token variable">$4</span> <span class="token operator">=</span> 0x603420
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603420<span class="token punctuation">)</span>
<span class="token variable">$5</span> <span class="token operator">=</span> 0x188
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603420 + <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token variable">$6</span> <span class="token operator">=</span> 0x603430
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603430<span class="token punctuation">)</span>
<span class="token variable">$7</span> <span class="token operator">=</span> 0x1d1
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603430 + <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token variable">$8</span> <span class="token operator">=</span> 0x603440
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603440<span class="token punctuation">)</span>
<span class="token variable">$9</span> <span class="token operator">=</span> 0x174
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603440 + <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token variable">$10</span> <span class="token operator">=</span> 0x603450
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603450<span class="token punctuation">)</span>
<span class="token variable">$11</span> <span class="token operator">=</span> 0x220
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603450 + <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token variable">$12</span> <span class="token operator">=</span> 0x603460
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x *<span class="token punctuation">(</span>0x603460 + <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token variable">$13</span> <span class="token operator">=</span> 0x0
</code></pre></div><p>故答案应为 6 5 3 1 2 4;</p> <h2 id="secret-phase"><a href="#secret-phase" class="header-anchor">#</a> secret_phase</h2> <p>正常通过前 6 关是无法触发 secret_phase 的,查看汇编发现,在 phase_4 答案之后输入 DrEvil 即可进入 secret_phase.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disas secret_phase
Dump of assembler code <span class="token keyword">for</span> <span class="token keyword">function</span> secret_phase:
   0x0000000000401191 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	push   %rbx
   0x0000000000401192 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	callq  0x40155c <span class="token operator">&lt;</span>read_line<span class="token operator">&gt;</span>
   0x0000000000401197 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	mov    <span class="token variable">$0xa</span>,%edx
   0x000000000040119c <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%esi
   0x00000000004011a1 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	mov    %rax,%rdi
   0x00000000004011a4 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	callq  0x400b80 <span class="token operator">&lt;</span>strtol@plt<span class="token operator">&gt;</span>
   0x00000000004011a9 <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    %rax,%rbx
   0x00000000004011ac <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	lea    -0x1<span class="token punctuation">(</span>%rax<span class="token punctuation">)</span>,%eax
   0x00000000004011af <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x3e8</span>,%eax
   0x00000000004011b4 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	jbe    0x4011bb <span class="token operator">&lt;</span>secret_phase+4<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>
   0x00000000004011b6 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x00000000004011bb <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	mov    %ebx,%esi
   0x00000000004011bd <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    <span class="token variable">$0x603230</span>,%edi
   0x00000000004011c2 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	callq  0x401153 <span class="token operator">&lt;</span>fun<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>
   0x00000000004011c7 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	<span class="token function">cmp</span>    <span class="token variable">$0x4</span>,%eax
   0x00000000004011ca <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	je     0x4011d1 <span class="token operator">&lt;</span>secret_phase+6<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>
   0x00000000004011cc <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	callq  0x4014e4 <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span>
   0x00000000004011d1 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	mov    <span class="token variable">$0x4024d0</span>,%edi
   0x00000000004011d6 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	callq  0x400ac0 <span class="token operator">&lt;</span>puts@plt<span class="token operator">&gt;</span>
   0x00000000004011db <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	callq  0x401682 <span class="token operator">&lt;</span>phase_defused<span class="token operator">&gt;</span>
   0x00000000004011e0 <span class="token operator">&lt;</span>+7<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	pop    %rbx
   0x00000000004011e1 <span class="token operator">&lt;</span>+8<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	retq
---Type <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to continue, or q <span class="token operator">&lt;</span>return<span class="token operator">&gt;</span> to quit---
End of assembler dump.
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disas fun7
Dump of assembler code <span class="token keyword">for</span> <span class="token keyword">function</span> fun7:
   0x0000000000401153 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	sub    <span class="token variable">$0x8</span>,%rsp
   0x0000000000401157 <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	<span class="token builtin class-name">test</span>   %rdi,%rdi
   0x000000000040115a <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	je     0x401187 <span class="token operator">&lt;</span>fun7+5<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>
   0x000000000040115c <span class="token operator">&lt;</span>+<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	mov    <span class="token punctuation">(</span>%rdi<span class="token punctuation">)</span>,%edx
   0x000000000040115e <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	<span class="token function">cmp</span>    %esi,%edx
   0x0000000000401160 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	jle    0x40116f <span class="token operator">&lt;</span>fun7+2<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
   0x0000000000401162 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	mov    0x8<span class="token punctuation">(</span>%rdi<span class="token punctuation">)</span>,%rdi
   0x0000000000401166 <span class="token operator">&lt;</span>+1<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>:	callq  0x401153 <span class="token operator">&lt;</span>fun<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>
   0x000000000040116b <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>:	<span class="token function">add</span>    %eax,%eax
   0x000000000040116d <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	jmp    0x40118c <span class="token operator">&lt;</span>fun7+5<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>
   0x000000000040116f <span class="token operator">&lt;</span>+2<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>:	mov    <span class="token variable">$0x0</span>,%eax
   0x0000000000401174 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span>:	<span class="token function">cmp</span>    %esi,%edx
   0x0000000000401176 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">5</span>&gt;</span>:	je     0x40118c <span class="token operator">&lt;</span>fun7+5<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>
   0x0000000000401178 <span class="token operator">&lt;</span>+3<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	mov    0x10<span class="token punctuation">(</span>%rdi<span class="token punctuation">)</span>,%rdi
   0x000000000040117c <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	callq  0x401153 <span class="token operator">&lt;</span>fun<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>
   0x0000000000401181 <span class="token operator">&lt;</span>+4<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>:	lea    0x1<span class="token punctuation">(</span>%rax,%rax,1<span class="token punctuation">)</span>,%eax
   0x0000000000401185 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>:	jmp    0x40118c <span class="token operator">&lt;</span>fun7+5<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>
   0x0000000000401187 <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>:	mov    <span class="token variable">$0xffffffff</span>,%eax
   0x000000000040118c <span class="token operator">&lt;</span>+5<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>:	<span class="token function">add</span>    <span class="token variable">$0x8</span>,%rsp
   0x0000000000401190 <span class="token operator">&lt;</span>+6<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>:	retq
End of assembler dump.
</code></pre></div><p>此题题意为在一个题目中构建好的平衡二叉树中从根节点开始查找一个输入的数.
由节点向左为 0,由节点向右为 1,查找路径序的 0-1 列从右向左构成一个二进制数,该
二进制数的十进制值必须等于题目中提供的数,其为 4,那么所需查找路径序列为 100,
根据二叉树结构,应该查找 7,故答案为 7.</p> <h2 id="运行截图"><a href="#运行截图" class="header-anchor">#</a> 运行截图</h2> <p><img src="/assets/img/ret1.636be771.png" alt="结果"></p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#准备工作" title="准备工作">准备工作</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#phase-1" title="phase_1">phase_1</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#phase-2" title="phase_2">phase_2</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#phase-3" title="phase_3">phase_3</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#phase-4" title="phase_4">phase_4</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#phase-5" title="phase_5">phase_5</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#phase-6" title="phase_6">phase_6</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#secret-phase" title="secret_phase">secret_phase</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#运行截图" title="运行截图">运行截图</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8><li class="contact-item" data-v-3d9deeb8><a href="https://github.com/jason210314" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-3d9deeb8><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-3d9deeb8></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8><li class="copyright-item" data-v-3d9deeb8><a href="https://policies.google.com/privacy?hl=en-US" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8>Privacy Policy</a></li><li class="copyright-item" data-v-3d9deeb8>MIT Licensed | Copyright © 2018-present</li></ul></div></footer></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.acf8092b.js" defer></script><script src="/assets/js/6.036fc43e.js" defer></script><script src="/assets/js/3.e3d55509.js" defer></script><script src="/assets/js/16.e7b2390a.js" defer></script><script src="/assets/js/9.151ac344.js" defer></script>
  </body>
</html>
